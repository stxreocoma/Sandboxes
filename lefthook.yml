pre-commit:
  parallel: true
  commands:
    gofmt:
      run: make fmt
    lint:
      run: make lint
    vet:
      run: go vet ./internal/...
    tidy:
      run: go mod tidy && git add go.mod

pre-push:
  commands:
    tests:
      run: make test

commit-msg:
  commands:
    conventional:
      runner: bash
      run: |
        MSG_FILE="{1}"        # ‚Üê lefthook –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ–æ–±—â–µ–Ω–∏—è
        HEADER="$(head -n1 "$MSG_FILE")"
        # allowed: feat|fix|refactor|perf|test|docs|ci|build|chore|style
        if ! echo "$HEADER" | grep -Eq '^(feat|fix|refactor|perf|test|docs|ci|build|chore|style)(\([a-zA-Z0-9_.-]+\))?!?: .{1,}$'; then
          echo "‚ùå Invalid commit message header:"
          echo "   $HEADER"
          echo "üëâ Use: type(scope)?: short description"
          echo "   Example: feat(pool): add queue overflow error"
          exit 1
        fi
      env:
        GIT_PARAMS: "{staged_files}"